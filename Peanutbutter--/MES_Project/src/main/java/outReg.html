<style>
    * {
        box-sizing: border-box;

    }

    .container {
        background-color: #F0F0E8;
        width: 100%;
        height: 100%;
        box-sizing: border-box;
    }

    body {
        margin: 0;
        padding: 0;
    }

    .top {
        color: #676767;
        font-size: 24px;
        font-weight: bold;
        height: 15vh;
    }

    .title {
        padding-top: 30px;
        margin-left: 100px;
    }

    .title img {
        vertical-align: middle;
        /* 이미지와 텍스트의 높낮이를 맞추기 위해 추가 */
    }

    .title span {
        vertical-align: middle;
        /* 이미지와 텍스트의 높낮이를 맞추기 위해 추가 */
    }



    .section {
        margin: 0 100px;
        height: 70vh;
        background-color: white;
        /* border: 1px solid red; */

    }

    .tableTopDiv {
        width: 100%;
        height: 30%;
        padding-top: 3px;
    }

    .table {
        border-collapse: collapse;
        /* 테두리가 겹치지 않도록 설정 */
        width: 100%;
    }

    th {
        background-color: #b6b6b6;
        border-right: 1px solid white;
    }

    td {
        text-align: center;
    }

    .tbody tr {
        border-bottom: 1px solid lightgray;
    }

    tr th,
    tr td {
        padding: 5px 0px;
    }

    .thead th:nth-child(1) {
        width: 5%;
    }

    .thead th:nth-child(2) {
        width: 20%;
    }

    .thead th:nth-child(3) {
        width: 20%;
    }

    .thead th:nth-child(4) {
        width: 15%;
    }

    .thead th:nth-child(5) {
        width: 15%;
    }

    .thead th:nth-child(6) {
        width: 10%;
    }

    .thead th:nth-child(7) {
        width: 15%;
    }



    .Btn_css {
        display: inline-block;
        /* span에 padding을 적용했을 때 부모 div 밖으로 벗어나는것을 막기위해서 */
        padding: 5px;
        background-color: #3F3B3B;
        color: white;
        border-radius: 5px;
        cursor: pointer;
    }

    .regBtn {
        margin: 0 100px;
        text-align: right;
        margin-top: 30px;
    }

    .inputText {
        height: 25px;
        margin-left: 30px;
        height: 100%;
    }

    .span {
        display: inline-block;
        width: 100px;
        font-weight: bold;
        vertical-align: top;
        height: 100%;
        text-align: center;
        /* 가로로 가운데정렬 */
        line-height: 30px;
        /* 세로로 가운데정렬 */
        margin-left: 100px;
    }

    .margin {
        margin-left: 100px;
    }

    .temp {
        height: 30px;
        margin: 5px;
    }

    input[type="text"] {
        text-align: center;
    }
</style>

<body>
    <div class="container">
        <div class="top">
            <div class="title">
                <img src="image/BOM.png" style="width: 30px;">
                <span>출고 작성</span>
            </div>
        </div>
        <div class="section">
            <div class="tableTopDiv">
                <div class="temp">
                    <span class="span">출고 NO(*)</span> <input type="text" class="inputText" id="PO_No">
                    <span class="span margin">출고 일자(*)</span> <input type="text" class="inputText" id="PO_date">
                </div>
                <div class="temp">
                    <span class="span">거래처(*)</span> <input type="text" class="inputText" id="account">
                    <span class="span margin">통화(*)</span> <input type="text" class="inputText" id="KRW">
                </div>
                <div class="temp">
                    <span class="span">비고사항</span> <input style="width: 350px;" type="text" class="inputText"
                        id="remark">
                    <span class="Btn_css" style="margin-left: 50px;" onclick="addRow()">행 추가</span>
                    <span class="Btn_css" style="margin-left: 20px;" onclick="deleteSelectedRow()">행 삭제</span>
                </div>
            </div>
            <table class="table">
                <thead class="thead">
                    <tr>
                        <th> </th>
                        <th>제품명</th>
                        <th>제품코드</th>
                        <th>단위</th>
                        <th>단가</th>
                        <th>출고 수량</th>
                        <th>합계</th>
                    </tr>
                </thead>
                <tbody class="tbody">
                    <tr>
                        <td><input type="checkbox" class="delete-checkbox"></td>
                        <td>LG그램 14인치</td>
                        <td>GRAM14-001</td>
                        <td>개</td>
                        <td>1,500,000</td>
                        <td>50</td>
                        <td>75,000,000</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="delete-checkbox"></td>
                        <td>LG그램 14인치</td>
                        <td>GRAM14-001</td>
                        <td>개</td>
                        <td>1,500,000</td>
                        <td>50</td>
                        <td>75,000,000</td>
                    </tr>
                </tbody>
            </table>

        </div>
        <div class="regBtn">
            <span class="Btn_css" style="padding:10px" onclick="commitReg()">완료</span>

        </div>
    </div>
</body>

<script>

    function addRow() { //행추가
        let tbody = document.querySelector('.tbody');

        let newRow = document.createElement('tr');
        newRow.innerHTML = `
                        <td><input type="checkbox" class="delete-checkbox"></td>
                        <td>
                            <select class="select">
                                <option value="-----">-----</option>
                                <option value="LG14">LG그램 14인치</option>
                                <option value="LG15">LG그램 15인치</option>
                                <option value="삼성">삼성노트북</option>
                            </select>
                        </td>
                        <td class="code"></td>
                        <td class="unit"></td>
                        <td class="price"></td>
                        <td><input class="count" type="text" style="width: 90%;" oninput="totalCount(this)"></td>
                        <td><span class="total"></span></td>
            `;

        tbody.appendChild(newRow);

        let newSelect = newRow.querySelector('.select');
        newSelect.addEventListener('change', function () {
            let selectValue = this.value;
            let code = newRow.querySelector('.code')
            let unit = newRow.querySelector('.unit')
            let price = newRow.querySelector('.price')

            if (selectValue === "LG14") {
                code.innerHTML = "GRAM14-001"
                price.innerHTML = "1,500,000"
            } else if (selectValue === "LG15") {
                code.innerHTML = "GRAM15-001"
                price.innerHTML = "1,800,000"
            } else if (selectValue === "삼성") {
                code.innerHTML = "SAMSUNG-001"
                price.innerHTML = "2,000,000"
            }
            unit.innerHTML = "개"
        })
    }

    function deleteSelectedRow() { //행삭제
        let checkboxes = document.querySelectorAll('.delete-checkbox');
        checkboxes.forEach(checkbox => {
            if (checkbox.checked) {
                checkbox.closest('tr').remove(); //closest : 특정 요소의 가장 가까운 조상 요소를 찾는 데 사용되는 DOM 메서드
            }
        });
    }

    function commitReg() {
        window.location.href = "finishStock.html";
    }

    function totalCount(input) {
        let row = input.closest('tr');
        let price = row.querySelector('.price').innerHTML;
        let count = input.value;
        let total = row.querySelector('.total');

        // 문자열을 숫자로 변환하고 곱셈 수행
        let priceNumber = parseInt(price.replace(/[^0-9]/g, '')); // 숫자가 아닌 문자 제거
        let countNumber = parseInt(count);
        let totalValue = priceNumber * countNumber;
        console.log("total : " + totalValue)
        if (!isNaN(totalValue)) {
            total.innerHTML = totalValue.toLocaleString(); // 숫자에 쉼표 추가
        } else {
            total.innerHTML = ''; // 값이 유효하지 않으면 빈 문자열
        }
    }
</script>